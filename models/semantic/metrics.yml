version: 2

semantic_models:
  - name: cost_of_risk_semantic_model
    model: ref('mrt_cost_of_risk')
    defaults:
      agg_time_dimension: cohort_month

    entities:
      - name: cost_record
        type: primary
        expr: risk_id
      - name: segment
        type: foreign
        expr: segment
      - name: seller_name
        type: foreign
        expr: seller_name

    dimensions:
      - name: cohort_month
        type: time
        type_params:
          time_granularity: month
      - name: segment
        type: categorical
      - name: seller_name
        type: categorical

    measures:
      - name: cost_of_risk
        agg: sum
        expr: cost_of_risk
      - name: total_face_value
        agg: sum
        expr: total_face_value
      - name: avg_provision_rate
        agg: average
        expr: avg_provision_rate
